#!MANAGED-CONFIG https://gitlab.com/abysses/w/raw/main/cloud.conf
[General]
# >> 日志等级 warning, notify, info, verbose (默认值: notify)
loglevel = warning
# >> Geoip CN
geoip-maxmind-url = https://cdn.jsdelivr.net/gh/caaby/geoip@release/country_cn.mmdb
# >> 禁用GeoIP数据库自动更新, false为允许自动更新
disable-geoip-db-auto-update = false
# > 兼容模式 (仅 iOS) Proxy with Loopback Address: 1, Proxy Only: 2, TUN Only: 3
compatibility-mode = 3
# >> IPv6 支持（默认关闭)
ipv6 = true
# >> Wi-Fi Assist 开启时，支持使用数据网络进行后备 DNS 查询
wifi-assist = true
# >> 测速超时（秒）
test-timeout = 3
# >> 网络测试 URL
internet-test-url=http://g.cn/generate_204
# >> 代理测速 URL
proxy-test-url=http://gstatic.com/generate_204

hijack-dns = 8.8.8.8:53, 8.8.4.4:53
udp-policy-not-supported-behaviour = REJECT
doh-skip-cert-verification = true
fast-switch = true
udp-priority = true 

[Proxy]
sg = wireguard, section-name=SG
jp = wireguard, section-name=JP
us1 = wireguard, section-name=US1
us2 = wireguard, section-name=US2
us3 = wireguard, section-name=US3
us4 = wireguard, section-name=US4
us5 = wireguard, section-name=US5

[Proxy Group]
# >> 代理
proxy = select, WG, AUTO, FAST, HK, TW, JP, SG, US
# >> 媒体
stream = select, WG, AUTO, FAST, HK, TW, JP, SG, US
# >> 网络广告
reject = select, REJECT, REJECT-DROP, REJECT-TINYGIF
# >> bilibili
bilibili = select, DIRECT, WG, AUTO, FAST, HK, TW, JP, SG, US
# >> apple
apple = select, DIRECT, HK, US, WG
# >> netflix
netflix = select, policy-path=VAR_NETFLIX_CONF_URL

#HK_TOR = url-test, policy-path=SURGE_URL&type=ss, policy-regex-filter=香港, no-alert=true, hidden=true, update-interval=20000

HK = url-test, policy-path=VAR_SERVERS_CONF_URL, policy-regex-filter=HK, no-alert=true, hidden=true, interval=300, tolerance=50, update-interval=7200
TW = url-test, policy-path=VAR_SERVERS_CONF_URL, policy-regex-filter=TW, no-alert=true, hidden=true, interval=300, tolerance=50, update-interval=7200
SG = url-test, policy-path=VAR_SERVERS_CONF_URL, policy-regex-filter=SG, no-alert=true, hidden=true, interval=300, tolerance=50, update-interval=7200
JP = url-test, policy-path=VAR_SERVERS_CONF_URL, policy-regex-filter=JP, no-alert=true, hidden=true, interval=300, tolerance=50, update-interval=7200
US = url-test, policy-path=VAR_SERVERS_CONF_URL, policy-regex-filter=US, no-alert=true, hidden=true, interval=300, tolerance=50, update-interval=7200
UK = url-test, policy-path=VAR_SERVERS_CONF_URL, policy-regex-filter=UK, no-alert=true, hidden=true, interval=300, tolerance=50, update-interval=7200
AT = url-test, policy-path=VAR_AUTO_CONF_URL, no-alert=true, hidden=true, interval=300, tolerance=50, update-interval=7200
FAST = load-balance, HK, TW, JP, SG, US, UK, AT no-alert=true, hidden=true, persistent=true
AUTO = url-test, HK, TW, JP, SG, US, UK, AT, no-alert=true, hidden=true
# >> wireguard
WG =  url-test, us1, us2, us3, us4, us5, jp, sg,  hidden=true, interval=300

[WireGuard US1]
private-key = VAR_PRIVATE_KEY
self-ip = 10.13.53.164
dns-server = 1.1.1.1
mtu = 1420
peer = (public-key = VAR_PUBLIC_KEY, allowed-ips = "0.0.0.0/0, ::0/0", endpoint = 6a27624.wa.cloudflare.systems:56386, keepalive = 25)

[WireGuard US2]
private-key = VAR_PRIVATE_KEY
self-ip = 10.13.53.164
dns-server = 1.1.1.1
mtu = 1420
peer = (public-key = VAR_PUBLIC_KEY, allowed-ips = "0.0.0.0/0, ::0/0", endpoint = 6a27624.wb.cloudflare.systems:56386 , keepalive = 25)

[WireGuard US3]
private-key = VAR_PRIVATE_KEY
self-ip = 10.13.53.164
dns-server = 1.1.1.1
mtu = 1420
peer = (public-key = VAR_PUBLIC_KEY, allowed-ips = "0.0.0.0/0, ::0/0", endpoint = 6a27624.wc.cloudflare.systems:56386, keepalive = 25)

[WireGuard JP]
private-key = VAR_PRIVATE_KEY
self-ip = 10.13.53.164
dns-server = 1.1.1.1
mtu = 1420
peer = (public-key = VAR_PUBLIC_KEY, allowed-ips = "0.0.0.0/0, ::0/0", endpoint = 6a27624.wd.cloudflare.systems:56386, keepalive = 25)

[WireGuard SG]
private-key = VAR_PRIVATE_KEY
self-ip = 10.13.53.164
dns-server = 1.1.1.1
mtu = 1420
peer = (public-key = VAR_PUBLIC_KEY, allowed-ips = "0.0.0.0/0, ::0/0", endpoint = 6a27624.we.cloudflare.systems:56386, keepalive = 25)

[WireGuard US4]
private-key = VAR_PRIVATE_KEY
self-ip = 10.13.53.164
dns-server = 1.1.1.1
mtu = 1420
peer = (public-key = VAR_PUBLIC_KEY, allowed-ips = "0.0.0.0/0, ::0/0", endpoint = 6a27624.wf.cloudflare.systems:56386, keepalive = 25)

[WireGuard US5]
private-key = VAR_PRIVATE_KEY
self-ip = 10.13.53.164
dns-server = 1.1.1.1
mtu = 1420
peer = (public-key = VAR_PUBLIC_KEY, allowed-ips = "0.0.0.0/0, ::0/0", endpoint = 6a27624.wx.cloudflare.systems:56386, keepalive = 25)


[Rule]
# >> Apple 服务
RULE-SET,https://cdn.jsdelivr.net/gh/blackmatrix7/ios_rule_script@master/rule/Surge/Apple/Apple.list, apple

# >> spotify
RULE-SET,https://cdn.jsdelivr.net/gh/blackmatrix7/ios_rule_script@master/rule/Surge/Spotify/Spotify.list, HK

# >> netflix
RULE-SET,https://cdn.jsdelivr.net/gh/blackmatrix7/ios_rule_script@master/rule/Loon/Netflix/Netflix.list, netflix

# >> disney
RULE-SET,https://cdn.jsdelivr.net/gh/blackmatrix7/ios_rule_script@master/rule/Loon/Disney/Disney.list, stream

# >> youtube
RULE-SET,https://cdn.jsdelivr.net/gh/blackmatrix7/ios_rule_script@master/rule/Surge/YouTube/YouTube.list, stream

# >> bilibili
RULE-SET,https://cdn.jsdelivr.net/gh/blackmatrix7/ios_rule_script@master/rule/Surge/BiliBili/BiliBili.list, bilibili

# >> telegram服务
RULE-SET,https://cdn.jsdelivr.net/gh/blackmatrix7/ios_rule_script@master/rule/Surge/Telegram/Telegram.list, proxy

# >> github.com 
RULE-SET,https://cdn.jsdelivr.net/gh/blackmatrix7/ios_rule_script@master/rule/Surge/GitHub/GitHub.list, HK

# >> Google
RULE-SET,https://cdn.jsdelivr.net/gh/blackmatrix7/ios_rule_script@master/rule/Surge/Google/Google.list, proxy

# >> Surge 自带了SYSTEM和LAN两个规则集，规则集包含的具体子规则会随Surge更新而有所调整。注意 LAN 规则集会触发 DNS 解析。
OR,((RULE-SET,SYSTEM), (RULE-SET,LAN), (GEOIP,CN), (RULE-SET, https://cdn.jsdelivr.net/gh/VirgilClyne/GetSomeFries@auto-update/ruleset/ASN.China.list)), DIRECT
# >> final
FINAL, proxy

[MITM]
skip-server-cert-verify = true
tcp-connection = true
h2 = true
ca-passphrase = MitM
ca-p12 = VAR_CA_P12
